<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Transaction Manager</title>

  <!-- CSS libs -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <style>
    :root{
      --purple-1:#6f42c1;
      --purple-2:#6a3dd6;
      --accent:#5b2ce7;
      --card-bg:#ffffff;
      --muted:#69707a;
      --text-primary:#222;
      --bg-primary:#f4f6fb;
      --border-color:#eaeef2;
      --success:#198754;
      --warning:#ffc107;
      --info:#0dcaf0;
      --danger:#dc3545;
      --secondary:#6c757d;
      --gradient-1: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --gradient-2: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      --gradient-3: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      --gradient-4: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
      --shadow-sm: 0 2px 10px rgba(0,0,0,0.04);
      --shadow-md: 0 8px 30px rgba(0,0,0,0.08);
      --shadow-lg: 0 15px 50px rgba(0,0,0,0.12);
    }

    /* Dark mode variables */
    [data-theme="dark"] {
      --purple-1:#8b66cc;
      --purple-2:#7d5ddb;
      --accent:#6d45f0;
      --card-bg:#2a2d3a;
      --muted:#a0a7b3;
      --text-primary:#f0f2f5;
      --bg-primary:#1a1d28;
      --border-color:#3a3f50;
      --success:#20c997;
      --warning:#fd7e14;
      --info:#3dd5f3;
      --danger:#e66572;
      --secondary:#8f96a1;
      --shadow-sm: 0 2px 10px rgba(0,0,0,0.2);
      --shadow-md: 0 8px 30px rgba(0,0,0,0.25);
      --shadow-lg: 0 15px 50px rgba(0,0,0,0.3);
    }

    html,body { 
      height:100%; 
      background:var(--bg-primary); 
      font-family: "Inter", "Segoe UI", system-ui, -apple-system, Roboto, "Helvetica Neue", Arial; 
      color:var(--text-primary);
      transition: background-color 0.3s, color 0.3s;
    }

    .page {
      max-width:1400px;
      margin:36px auto;
      padding:22px;
    }

    .app-card {
      background:var(--card-bg);
      border-radius:20px;
      box-shadow: var(--shadow-lg);
      overflow:visible;
      padding:0;
      transition: background-color 0.3s, box-shadow 0.3s;
      border: 1px solid var(--border-color);
    }

    /* Header */
    .tm-header {
      border-radius:20px 20px 0 0;
      padding:24px 32px;
      background: var(--gradient-1);
      color:white;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      position: relative;
      overflow: hidden;
    }
    .tm-header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" opacity="0.1"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="50" cy="50" r="1" fill="white"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
    }
    .tm-header h2 { 
      margin:0; 
      font-weight:800; 
      font-size:24px; 
      display:flex; 
      align-items:center; 
      gap:12px; 
      position: relative;
      z-index: 1;
    }
    .tm-header .header-actions { 
      display:flex; 
      gap:12px; 
      align-items:center; 
      position: relative;
      z-index: 1;
    }
    .btn-outline-light {
      border: 1px solid rgba(255,255,255,0.25);
      color: white;
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(10px);
      transition: all 0.3s;
    }
    .btn-outline-light:hover {
      background: rgba(255,255,255,0.2);
      transform: translateY(-2px);
    }

    /* top cards */
    .top-cards { 
      display:grid; 
      grid-template-columns: repeat(4,1fr); 
      gap:24px; 
      padding:28px; 
    }
    .stat-card {
      background:var(--card-bg);
      border-radius:16px;
      padding:24px;
      box-shadow: var(--shadow-md);
      border: 1px solid var(--border-color);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--gradient-1);
    }
    .stat-card:nth-child(2)::before {
      background: var(--gradient-2);
    }
    .stat-card:nth-child(3)::before {
      background: var(--gradient-3);
    }
    .stat-card:nth-child(4)::before {
      background: var(--gradient-4);
    }
    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-lg);
    }
    .stat-label { 
      font-size:13px; 
      color:var(--muted); 
      letter-spacing:1px; 
      text-transform:uppercase; 
      font-weight:600;
      margin-bottom: 8px;
    }
    .stat-value { 
      font-size:28px; 
      font-weight:800; 
      margin:12px 0 8px;
    }
    .stat-trend {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 13px;
      font-weight: 600;
    }

    /* info banner */
    .info-banner { 
      padding:18px 28px; 
      border-top:1px solid var(--border-color); 
      border-bottom:1px solid var(--border-color); 
      background:var(--card-bg); 
      color:var(--text-primary);
      transition: background-color 0.3s, border-color 0.3s;
      display: flex;
      align-items: center;
      gap: 12px;
      font-weight: 500;
    }
    .info-banner i {
      color: var(--accent);
      font-size: 18px;
    }

    /* content body */
    .content-body { 
      padding:24px 28px 36px; 
    }

    /* table */
    .transactions-table { 
      border-radius:16px; 
      overflow:hidden; 
      border:1px solid var(--border-color); 
      background:var(--card-bg); 
      box-shadow: var(--shadow-sm); 
      max-height: 600px; 
      overflow: auto; 
      transition: background-color 0.3s, border-color 0.3s;
    }
    .transactions-table table { 
      margin:0; 
      min-width: 1200px; 
      border-collapse: separate;
      border-spacing: 0;
    }
    .transactions-table thead th { 
      background:var(--card-bg); 
      color:var(--muted); 
      font-weight:700; 
      border-bottom:2px solid var(--border-color); 
      padding:18px 16px; 
      position: sticky;
      top: 0;
      background-color: var(--card-bg);
      z-index: 10;
      transition: background-color 0.3s, border-color 0.3s;
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .transactions-table tbody td { 
      padding:16px; 
      vertical-align:middle; 
      border-bottom:1px solid var(--border-color); 
      transition: background-color 0.3s;
      font-weight: 500;
    }
    .transactions-table tbody tr:nth-child(even) td { 
      background: rgba(0,0,0,0.02); 
    }
    [data-theme="dark"] .transactions-table tbody tr:nth-child(even) td {
      background: rgba(255,255,255,0.02);
    }
    .transactions-table tbody tr:hover td {
      background: rgba(111, 66, 193, 0.05);
    }
    .transactions-table tbody tr.selected td { 
      background-color: rgba(111, 66, 193, 0.1); 
    }

    .badge-income { 
      background-color: rgba(15, 122, 58, 0.15);
      color: var(--success);
      font-weight:700;
      padding: 6px 12px;
      border-radius: 8px;
      font-size: 12px;
    }
    .badge-expense { 
      background-color: rgba(220, 53, 69, 0.15);
      color: var(--danger);
      font-weight:700;
      padding: 6px 12px;
      border-radius: 8px;
      font-size: 12px;
    }
    .badge-transfer { 
      background-color: rgba(13, 202, 240, 0.15);
      color: var(--info);
      font-weight:700;
      padding: 6px 12px;
      border-radius: 8px;
      font-size: 12px;
    }

    /* action buttons */
    .action-btn { 
      width:38px; 
      height:38px; 
      border-radius:10px; 
      display:inline-flex; 
      align-items:center; 
      justify-content:center; 
      color:white; 
      border:none;
      transition: all 0.3s;
    }
    .action-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    .btn-view { background:var(--info); }
    .btn-edit { background:var(--warning); color:#111; }
    .btn-del { background:var(--danger); }

    /* pagination */
    .pagination-wrap { 
      display:flex; 
      justify-content:center; 
      padding-top:24px; 
      gap:10px; 
    }
    .page-link {
      color: var(--purple-1);
      background-color: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      padding: 8px 16px;
      font-weight: 600;
      transition: all 0.3s;
    }
    .page-link:hover {
      color: white;
      background-color: var(--purple-1);
      border-color: var(--purple-1);
      transform: translateY(-2px);
    }
    .page-item.active .page-link {
      color: white;
      background-color: var(--purple-1);
      border-color: var(--purple-1);
      box-shadow: 0 4px 12px rgba(111, 66, 193, 0.3);
    }

    .floating-add {
      position:fixed; 
      right:30px; 
      bottom:30px; 
      width:70px; 
      height:70px; 
      border-radius:50%;
      background: var(--gradient-1);
      color:white; 
      display:flex; 
      align-items:center; 
      justify-content:center; 
      box-shadow:0 10px 30px rgba(70,34,173,0.3); 
      z-index:1200;
      cursor:pointer;
      transition: all 0.3s;
      border: none;
      font-size: 24px;
    }
    .floating-add:hover {
      transform: scale(1.1) rotate(90deg);
      box-shadow: 0 15px 40px rgba(70,34,173,0.4);
    }

    /* responsive */
    @media (max-width: 1200px) {
      .top-cards { grid-template-columns: repeat(2,1fr); }
    }
    @media (max-width: 768px) {
      .top-cards { grid-template-columns: 1fr; gap:16px; }
      .tm-header { flex-direction:column; align-items:flex-start; gap:16px; border-radius:20px 20px 0 0; }
      .page { padding:16px; }
      .content-body { padding:20px 16px 28px; }
    }

    /* filters area inside content */
    .filters { 
      display:flex; 
      gap:12px; 
      flex-wrap:wrap; 
      align-items:center; 
      margin-bottom:20px; 
      padding: 20px;
      background: var(--card-bg);
      border-radius: 16px;
      border: 1px solid var(--border-color);
      box-shadow: var(--shadow-sm);
    }
    .filters .form-select, .filters .form-control { 
      min-width:160px; 
      background-color: var(--card-bg);
      color: var(--text-primary);
      border-color: var(--border-color);
      border-radius: 10px;
      padding: 10px 16px;
      font-weight: 500;
    }
    .filters .btn {
      border-radius: 10px;
      padding: 10px 20px;
      font-weight: 600;
      transition: all 0.3s;
    }
    .filters .btn:hover {
      transform: translateY(-2px);
    }

    .small-muted { 
      font-size:13px; 
      color:var(--muted); 
    }
    
    /* Bank balance section */
    .bank-balances {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      margin-bottom: 24px;
      padding: 20px;
      background: var(--card-bg);
      border-radius: 16px;
      border: 1px solid var(--border-color);
      box-shadow: var(--shadow-sm);
      transition: background-color 0.3s, border-color 0.3s;
    }
    .bank-balance-item {
      background: var(--bg-primary);
      padding: 16px 20px;
      border-radius: 12px;
      box-shadow: var(--shadow-sm);
      min-width: 200px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: all 0.3s;
      border: 1px solid var(--border-color);
      flex: 1;
      min-width: 180px;
    }
    .bank-balance-item:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-md);
    }
    .bank-balance-name {
      font-weight: 600;
      font-size: 14px;
      color: var(--muted);
    }
    .bank-balance-value {
      font-weight: 800;
      font-size: 18px;
    }
    .positive-balance { color: var(--success); }
    .negative-balance { color: var(--danger); }
    
    /* Balance visibility toggle */
    .balance-toggle {
      background: none;
      border: none;
      cursor: pointer;
      color: var(--muted);
      font-size: 16px;
      margin-left: 8px;
      transition: all 0.3s;
    }
    .balance-toggle:hover {
      color: var(--accent);
      transform: scale(1.1);
    }
    .balance-hidden {
      filter: blur(5px);
      user-select: none;
    }
    
    /* Navigation buttons */
    .nav-buttons {
      display: flex;
      gap: 12px;
      margin-bottom: 24px;
      flex-wrap: wrap;
    }
    .nav-buttons .btn {
      border-radius: 12px;
      padding: 10px 20px;
      font-weight: 600;
      transition: all 0.3s;
    }
    .nav-buttons .btn:hover {
      transform: translateY(-2px);
    }
    
    /* Attachment preview */
    .attachment-preview {
      max-width: 100%;
      max-height: 150px;
      margin-top: 10px;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      display: none;
    }
    
    /* Color coding for income and expense */
    .income-color {
      color: var(--success);
    }
    .expense-color {
      color: var(--danger);
    }
    
    /* Upload progress bar */
    .upload-progress {
      height: 6px;
      margin-top: 8px;
      border-radius: 3px;
      background: var(--border-color);
      display: none;
    }
    .upload-progress-bar {
      height: 100%;
      border-radius: 3px;
      background: var(--accent);
      width: 0%;
      transition: width 0.3s;
    }
    
    /* Loading spinner */
    .spinner-border-sm {
      width: 1rem;
      height: 1rem;
    }
    
    /* Theme toggle */
    .theme-toggle {
      background: none;
      border: none;
      color: white;
      font-size: 1.3rem;
      cursor: pointer;
      margin-left: 10px;
      transition: all 0.3s;
    }
    .theme-toggle:hover {
      transform: rotate(30deg);
    }
    
    /* Export buttons */
    .export-buttons {
      display: flex;
      gap: 10px;
      margin-left: auto;
    }
    
    /* Time toggle */
    .time-toggle-container {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 8px;
    }
    
    /* Form styles */
    .form-control, .form-select {
      background-color: var(--card-bg);
      color: var(--text-primary);
      border-color: var(--border-color);
      border-radius: 10px;
      padding: 12px 16px;
      transition: all 0.3s;
    }
    .form-control:focus, .form-select:focus {
      background-color: var(--card-bg);
      color: var(--text-primary);
      border-color: var(--purple-1);
      box-shadow: 0 0 0 0.25rem rgba(111, 66, 193, 0.25);
      transform: translateY(-2px);
    }
    
    /* Modal styles */
    .modal-content {
      background-color: var(--card-bg);
      color: var(--text-primary);
      border-radius: 20px;
      border: 1px solid var(--border-color);
      box-shadow: var(--shadow-lg);
    }
    .modal-header {
      border-bottom-color: var(--border-color);
      padding: 24px 24px 0;
    }
    .modal-header .modal-title {
      font-weight: 700;
      font-size: 1.5rem;
    }
    .modal-body {
      padding: 24px;
    }
    .modal-footer {
      border-top-color: var(--border-color);
      padding: 16px 24px 24px;
    }
    
    /* Chart container */
    .chart-container {
      height: 320px;
      margin-bottom: 24px;
      background: var(--card-bg);
      border-radius: 16px;
      padding: 20px;
      border: 1px solid var(--border-color);
      box-shadow: var(--shadow-sm);
    }
    
    /* Quick stats */
    .quick-stats {
      display: flex;
      gap: 12px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    .quick-stat {
      padding: 12px 16px;
      background: var(--card-bg);
      border-radius: 12px;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 8px;
      border: 1px solid var(--border-color);
      box-shadow: var(--shadow-sm);
      transition: all 0.3s;
      flex: 1;
      min-width: 200px;
    }
    .quick-stat:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-md);
    }
    .quick-stat i {
      font-size: 18px;
    }
    
    /* Loading modal */
    #loadingModal .modal-content {
      background: transparent;
      border: none;
      box-shadow: none;
    }
    #loadingModal .modal-body {
      text-align: center;
      color: white;
    }
    
    /* Bulk actions */
    .bulk-actions {
      display: flex;
      gap: 12px;
      margin-bottom: 20px;
      padding: 16px 20px;
      background: var(--card-bg);
      border-radius: 16px;
      border: 1px solid var(--border-color);
      box-shadow: var(--shadow-sm);
      align-items: center;
      transition: all 0.3s;
    }
    .bulk-actions.hidden {
      display: none;
    }
    .bulk-count {
      font-weight: 700;
      color: var(--purple-1);
      font-size: 16px;
    }
    .bulk-actions .btn {
      border-radius: 10px;
      padding: 8px 16px;
      font-weight: 600;
    }
    
    /* Split transaction styles */
    .split-transaction-item {
      border: 1px solid var(--border-color);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 16px;
      background: var(--bg-primary);
      transition: all 0.3s;
    }
    .split-transaction-item:hover {
      box-shadow: var(--shadow-sm);
    }
    .split-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }
    .split-amount {
      font-weight: 700;
      color: var(--purple-1);
    }
    .remove-split {
      background: var(--danger);
      color: white;
      border: none;
      border-radius: 8px;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
    }
    .remove-split:hover {
      transform: scale(1.1);
    }
    .split-summary {
      margin-top: 20px;
      padding: 16px;
      background: var(--card-bg);
      border-radius: 12px;
      font-weight: 600;
      border: 1px solid var(--border-color);
    }
    .amount-remaining {
      color: var(--success);
    }
    .amount-exceeded {
      color: var(--danger);
    }
    
    /* Checkbox in table */
    .transaction-checkbox {
      width: 20px;
      height: 20px;
      border-radius: 6px;
      cursor: pointer;
    }
    
    /* Quick Add Multiple Transactions */
    .quick-add-multiple {
      margin-top: 20px;
      padding: 20px;
      background: var(--bg-primary);
      border-radius: 12px;
      border: 1px solid var(--border-color);
    }
    .multiple-transaction {
      border: 1px solid var(--border-color);
      border-radius: 10px;
      padding: 16px;
      margin-bottom: 12px;
      background: var(--card-bg);
    }
    .add-transaction-btn {
      width: 100%;
      padding: 12px;
      border: 2px dashed var(--border-color);
      border-radius: 10px;
      background: transparent;
      color: var(--muted);
      transition: all 0.3s;
    }
    .add-transaction-btn:hover {
      border-color: var(--accent);
      color: var(--accent);
      transform: translateY(-2px);
    }
    
    /* Animation for new elements */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .fade-in {
      animation: fadeIn 0.3s ease-out;
    }
  </style>
</head>
<body>
  <div class="page">
    <!-- Navigation buttons -->
    <div class="nav-buttons">
      <button id="backBtn" class="btn btn-outline-primary">
        <i class="fa fa-arrow-left me-2"></i> Back
      </button>
      <button id="homeBtn" class="btn btn-outline-secondary">
        <i class="fa fa-home me-2"></i> Home
      </button>
      <button id="coaBtn" class="btn btn-outline-info">
        <i class="fa fa-chart-pie me-2"></i> Manage COA
      </button>
      <div class="export-buttons">
        <button id="exportCSV" class="btn btn-outline-success">
          <i class="fa fa-file-csv me-2"></i> Export CSV
        </button>
        <button id="exportPDF" class="btn btn-outline-danger">
          <i class="fa fa-file-pdf me-2"></i> Export PDF
        </button>
      </div>
    </div>
    
    <div class="app-card">
      <!-- header -->
      <div class="tm-header">
        <h2><i class="fa fa-money-bill-wave"></i> Transaction Manager</h2>
        <div class="header-actions">
          <button id="newTxBtn" class="btn btn-light btn-sm text-primary">
            <i class="fa fa-plus me-2"></i> New Transaction
          </button>
          <button id="quickAddBtn" class="btn btn-light btn-sm text-primary ms-2">
            <i class="fa fa-bolt me-2"></i> Quick Add
          </button>
          <button id="splitIncomeBtn" class="btn btn-light btn-sm text-primary ms-2">
            <i class="fa fa-share-alt me-2"></i> Split Income
          </button>
          <button id="themeToggle" class="theme-toggle">
            <i class="fa fa-moon"></i>
          </button>
          <div style="width:1px;height:36px;background:rgba(255,255,255,0.25); margin-left:12px;"></div>
          <div style="display:flex;align-items:center; gap:12px; margin-left:12px;">
            <div id="userInitials" style="width:40px;height:40px;border-radius:50%; background:rgba(255,255,255,0.15); display:flex;align-items:center;justify-content:center;font-weight:800; font-size:16px;">U</div>
            <div style="color:white; font-weight:700;" id="username">User</div>
            <button id="logoutBtn" class="btn btn-outline-light btn-sm">Logout</button>
          </div>
        </div>
      </div>

      <!-- Bulk Actions -->
      <div id="bulkActions" class="bulk-actions hidden">
        <span class="bulk-count" id="selectedCount">0 transactions selected</span>
        <button id="bulkDeleteBtn" class="btn btn-outline-danger btn-sm">
          <i class="fa fa-trash me-2"></i> Delete Selected
        </button>
        <button id="bulkEditBtn" class="btn btn-outline-warning btn-sm">
          <i class="fa fa-edit me-2"></i> Edit Selected
        </button>
        <button id="clearSelectionBtn" class="btn btn-outline-secondary btn-sm">
          <i class="fa fa-times me-2"></i> Clear Selection
        </button>
      </div>

      <!-- top cards -->
      <div class="top-cards" id="topCards">
        <div class="stat-card">
          <div class="stat-label">Total Income</div>
          <div id="statIncome" class="stat-value income-color">$414,205.57</div>
          <div class="stat-trend"><i class="fa fa-arrow-up text-success"></i> 12.5% increase</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Total Expenses</div>
          <div id="statExpense" class="stat-value expense-color">$414,172.57</div>
          <div class="stat-trend"><i class="fa fa-arrow-down text-danger"></i> 8.3% decrease</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Current Balance</div>
          <div id="statBalance" class="stat-value balance-hidden">$33.00</div>
          <div class="small-muted">
            <button id="balanceToggle" class="balance-toggle" title="Toggle balance visibility">
              <i class="fa fa-eye-slash"></i>
            </button>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Transactions</div>
          <div id="statCount" class="stat-value">1,176</div>
          <div class="small-muted">This month: 147</div>
        </div>
      </div>
      
      <!-- Quick stats -->
      <div class="quick-stats" id="quickStats">
        <div class="quick-stat">
          <i class="fa fa-arrow-up text-success"></i>
          <span>Monthly Income: <strong>$1,270.00</strong></span>
        </div>
        <div class="quick-stat">
          <i class="fa fa-arrow-down text-danger"></i>
          <span>Monthly Expenses: <strong>$1,477.00</strong></span>
        </div>
        <div class="quick-stat">
          <i class="fa fa-chart-line text-info"></i>
          <span>Avg Transaction: <strong>$704.40</strong></span>
        </div>
        <div class="quick-stat">
          <i class="fa fa-list text-primary"></i>
          <span>Transactions: <strong>23/113/11</strong></span>
        </div>
      </div>
      
      <!-- Chart container -->
      <div class="chart-container" id="transactionsChart">
        <!-- Chart will be rendered here -->
      </div>
      
      <!-- Bank balances section -->
      <div class="info-banner">
        <i class="fa fa-info-circle"></i> Manage your transactions, view attachments, and track your finances in one place.
      </div>
      
      <div class="content-body">
        <!-- Bank balances -->
        <div id="bankBalances" class="bank-balances">
          <div class="bank-balance-item">
            <div class="bank-balance-name">AXIS</div>
            <div class="bank-balance-value positive-balance">$12,450.00</div>
            <button class="balance-toggle" title="Toggle balance visibility">
              <i class="fa fa-eye"></i>
            </button>
          </div>
          <div class="bank-balance-item">
            <div class="bank-balance-name">BOM</div>
            <div class="bank-balance-value positive-balance">$8,230.50</div>
            <button class="balance-toggle" title="Toggle balance visibility">
              <i class="fa fa-eye"></i>
            </button>
          </div>
          <div class="bank-balance-item">
            <div class="bank-balance-name">CASH</div>
            <div class="bank-balance-value positive-balance">$450.00</div>
            <button class="balance-toggle" title="Toggle balance visibility">
              <i class="fa fa-eye"></i>
            </button>
          </div>
          <div class="bank-balance-item">
            <div class="bank-balance-name">SBI</div>
            <div class="bank-balance-value positive-balance">$15,780.25</div>
            <button class="balance-toggle" title="Toggle balance visibility">
              <i class="fa fa-eye"></i>
            </button>
          </div>
        </div>
        
        <!-- filters -->
        <div class="filters mb-4">
          <select id="dateFilter" class="form-select form-select-sm">
            <option value="all">All Dates</option>
            <option value="today">Today</option>
            <option value="week">This Week</option>
            <option value="month">This Month</option>
            <option value="year">This Year</option>
            <option value="custom">Custom Range</option>
          </select>

          <div id="customRangeControls" style="display:none; display:flex; gap:10px;">
            <input id="startDate" type="date" class="form-control form-control-sm" />
            <input id="endDate" type="date" class="form-control form-control-sm" />
          </div>

          <select id="typeFilter" class="form-select form-select-sm">
            <option value="all">All Types</option>
            <option value="income">Income</option>
            <option value="expense">Expense</option>
            <option value="transfer">Transfer</option>
          </select>

          <!-- Bank Filter -->
          <select id="bankFilter" class="form-select form-select-sm">
            <option value="all">All Banks</option>
            <option value="AXIS">AXIS</option>
            <option value="BOM">BOM</option>
            <option value="CASH">CASH</option>
            <option value="SBI">SBI</option>
          </select>

          <input id="searchDesc" class="form-control form-control-sm" placeholder="Search description..." />

          <button id="applyFiltersBtn" class="btn btn-sm btn-primary"><i class="fa fa-search me-2"></i> Apply</button>
          <button id="resetFiltersBtn" class="btn btn-sm btn-outline-secondary">Reset</button>
          <button id="advancedFiltersBtn" class="btn btn-sm btn-outline-info">Advanced</button>
          <button id="selectAllBtn" class="btn btn-sm btn-outline-primary">Select All</button>
          <button id="deselectAllBtn" class="btn btn-sm btn-outline-secondary">Deselect All</button>
        </div>
        
        <!-- Advanced filters (initially hidden) -->
        <div id="advancedFilters" style="display: none;" class="filters mb-4">
          <input id="minAmount" type="number" class="form-control form-control-sm" placeholder="Min Amount" step="0.01" />
          <input id="maxAmount" type="number" class="form-control form-control-sm" placeholder="Max Amount" step="0.01" />
          <select id="sortBy" class="form-select form-select-sm">
            <option value="date-desc">Date (Newest First)</option>
            <option value="date-asc">Date (Oldest First)</option>
            <option value="amount-desc">Amount (High to Low)</option>
            <option value="amount-asc">Amount (Low to High)</option>
          </select>
        </div>

        <!-- transactions table -->
        <div class="transactions-table">
          <table class="table mb-0">
            <thead>
              <tr>
                <th style="width:50px;">
                  <input type="checkbox" id="selectAllCheckbox" class="transaction-checkbox">
                </th>
                <th style="width:120px;">Date</th>
                <th style="width:140px;">Account Header</th>
                <th>Description</th>
                <th style="width:100px;">Type</th>
                <th style="width:120px;">Voucher #</th>
                <th style="width:120px;">Bank Name</th>
                <th style="width:120px; text-align:right;">Income</th>
                <th style="width:120px; text-align:right;">Expense</th>
                <th style="width:120px; text-align:right;">Balance</th>
                <th style="width:120px;">Attachment</th>
                <th style="width:140px;">Actions</th>
              </tr>
            </thead>
            <tbody id="transactionsTableBody">
              <tr class="fade-in">
                <td>
                  <input type="checkbox" class="transaction-checkbox row-checkbox" data-id="1">
                </td>
                <td>2025-11-19</td>
                <td>Petrol</td>
                <td>Icon Give x Petrol</td>
                <td><span class="badge badge-income">Income</span></td>
                <td>1167</td>
                <td>CASH</td>
                <td style="text-align:right;"><span class="income-color">$120.00</span></td>
                <td style="text-align:right;">$0.00</td>
                <td style="text-align:right;">••••</td>
                <td>
                  <span class="text-muted">None</span>
                </td>
                <td>
                  <div class="d-flex gap-1">
                    <button class="action-btn btn-view"><i class="fa fa-eye"></i></button>
                    <button class="action-btn btn-edit"><i class="fa fa-edit"></i></button>
                    <button class="action-btn btn-del"><i class="fa fa-trash"></i></button>
                  </div>
                </td>
              </tr>
              <tr class="fade-in">
                <td>
                  <input type="checkbox" class="transaction-checkbox row-checkbox" data-id="2">
                </td>
                <td>2025-11-18</td>
                <td>Utilities</td>
                <td>Recharge Express</td>
                <td><span class="badge badge-expense">Expense</span></td>
                <td>1166</td>
                <td>AXIS</td>
                <td style="text-align:right;">$0.00</td>
                <td style="text-align:right;"><span class="expense-color">$29.00</span></td>
                <td style="text-align:right;">••••</td>
                <td>
                  <span class="text-muted">None</span>
                </td>
                <td>
                  <div class="d-flex gap-1">
                    <button class="action-btn btn-view"><i class="fa fa-eye"></i></button>
                    <button class="action-btn btn-edit"><i class="fa fa-edit"></i></button>
                    <button class="action-btn btn-del"><i class="fa fa-trash"></i></button>
                  </div>
                </td>
              </tr>
              <tr class="fade-in">
                <td>
                  <input type="checkbox" class="transaction-checkbox row-checkbox" data-id="3">
                </td>
                <td>2025-11-18</td>
                <td>Food</td>
                <td>Buy snacks</td>
                <td><span class="badge badge-expense">Expense</span></td>
                <td>1165</td>
                <td>AXIS</td>
                <td style="text-align:right;">$0.00</td>
                <td style="text-align:right;"><span class="expense-color">$40.00</span></td>
                <td style="text-align:right;">••••</td>
                <td>
                  <span class="text-muted">None</span>
                </td>
                <td>
                  <div class="d-flex gap-1">
                    <button class="action-btn btn-view"><i class="fa fa-eye"></i></button>
                    <button class="action-btn btn-edit"><i class="fa fa-edit"></i></button>
                    <button class="action-btn btn-del"><i class="fa fa-trash"></i></button>
                  </div>
                </td>
              </tr>
              <tr class="fade-in">
                <td>
                  <input type="checkbox" class="transaction-checkbox row-checkbox" data-id="4">
                </td>
                <td>2025-11-17</td>
                <td>Healthcare</td>
                <td>Buy Medicine</td>
                <td><span class="badge badge-expense">Expense</span></td>
                <td>1164</td>
                <td>AXIS</td>
                <td style="text-align:right;">$0.00</td>
                <td style="text-align:right;"><span class="expense-color">$50.00</span></td>
                <td style="text-align:right;">••••</td>
                <td>
                  <span class="text-muted">None</span>
                </td>
                <td>
                  <div class="d-flex gap-1">
                    <button class="action-btn btn-view"><i class="fa fa-eye"></i></button>
                    <button class="action-btn btn-edit"><i class="fa fa-edit"></i></button>
                    <button class="action-btn btn-del"><i class="fa fa-trash"></i></button>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- pagination -->
        <div class="pagination-wrap mt-4" id="paginationControls">
          <nav>
            <ul class="pagination pagination-sm">
              <li class="page-item disabled">
                <a class="page-link" href="#">Previous</a>
              </li>
              <li class="page-item active">
                <a class="page-link" href="#">1</a>
              </li>
              <li class="page-item">
                <a class="page-link" href="#">2</a>
              </li>
              <li class="page-item">
                <a class="page-link" href="#">3</a>
              </li>
              <li class="page-item">
                <a class="page-link" href="#">Next</a>
              </li>
            </ul>
          </nav>
        </div>
      </div>
    </div>
  </div>

  <!-- Modals -->
  <!-- Add/Edit Transaction Modal -->
  <div class="modal fade" id="transactionModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="transactionModalLabel">Add Transaction</h5>
          <button class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="transactionForm">
            <input type="hidden" id="txId" />
            <div class="row g-3">
              <div class="col-md-3">
                <label class="form-label">Date</label>
                <input id="formDATE" type="date" class="form-control" required />
              </div>
              <div class="col-md-3">
                <label class="form-label">Time (Optional)</label>
                <input id="formTIME" type="time" class="form-control" />
                <div class="time-toggle-container">
                  <input type="checkbox" id="includeTime" class="form-check-input">
                  <label class="form-check-label small-muted" for="includeTime">Include time</label>
                </div>
              </div>
              <div class="col-md-3">
                <label class="form-label">Voucher # (SINO)</label>
                <input id="formSINO" type="text" class="form-control" />
              </div>
              <div class="col-md-3">
                <label class="form-label">Account Header</label>
                <select id="formACCOUNTHEADER" class="form-select">
                  <option value="">Select Account Header</option>
                  <option value="Petrol">Petrol</option>
                  <option value="Utilities">Utilities</option>
                  <option value="Food">Food</option>
                  <option value="Healthcare">Healthcare</option>
                  <option value="Shopping">Shopping</option>
                </select>
              </div>
            </div>

            <div class="row g-3 mt-2">
              <div class="col-md-3">
                <label class="form-label">Voucher Type</label>
                <select id="formVOUCHERTYPE" class="form-select">
                  <option value="Payment">Payment</option>
                  <option value="Receipt">Receipt</option>
                  <option value="Journal">Journal</option>
                  <option value="Transfer">Transfer</option>
                </select>
              </div>
              <div class="col-md-3">
                <label class="form-label">Type</label>
                <select id="formTYPE" class="form-select">
                  <option value="Income">Income</option>
                  <option value="Expense">Expense</option>
                  <option value="Transfer">Transfer</option>
                </select>
              </div>
              <div class="col-md-3">
                <label class="form-label">Bank Name</label>
                <select id="formBANKNAME" class="form-select">
                  <option value="">Select Bank</option>
                  <option value="AXIS">AXIS</option>
                  <option value="BOM">BOM</option>
                  <option value="CASH">CASH</option>
                  <option value="SBI">SBI</option>
                </select>
              </div>
              <div class="col-md-3">
                <label class="form-label">Currency</label>
                <select id="formCURRENCY" class="form-select">
                  <option value="USD">USD ($)</option>
                  <option value="EUR">EUR (€)</option>
                  <option value="GBP">GBP (£)</option>
                  <option value="INR">INR (₹)</option>
                </select>
              </div>
            </div>

            <div class="row g-3 mt-2">
              <div class="col-md-3">
                <label class="form-label">Income</label>
                <input id="formINCOME" type="number" step="0.01" class="form-control" />
              </div>
              <div class="col-md-3">
                <label class="form-label">Expense</label>
                <input id="formEXPENSE" type="number" step="0.01" class="form-control" />
              </div>
              <div class="col-md-3">
                <label class="form-label">Balance (manual)</label>
                <input id="formBALANCE" type="number" step="0.01" class="form-control" />
              </div>
              <div class="col-md-3">
                <label class="form-label">Notes</label>
                <input id="formNOTES" type="text" class="form-control" placeholder="Enter notes" />
              </div>
            </div>

            <div class="row g-3 mt-2">
              <div class="col-md-8">
                <label class="form-label">Description</label>
                <textarea id="formDESCRIPTION" class="form-control" rows="2" placeholder="Enter description"></textarea>
              </div>
              <div class="col-md-4">
                <label class="form-label">Attachment</label>
                <input id="formATTACHFILE" type="file" class="form-control" accept=".pdf,.doc,.docx,.xls,.xlsx,.txt,image/*" />
                <input id="formATTACH" type="hidden" />
                <div class="upload-progress" id="uploadProgress">
                  <div class="upload-progress-bar" id="uploadProgressBar"></div>
                </div>
                <img id="attachmentPreview" class="attachment-preview" alt="Preview" />
                <div id="attachmentInfo" class="small-muted mt-1"></div>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button data-bs-dismiss="modal" class="btn btn-outline-secondary">Cancel</button>
          <button id="saveTransactionBtn" class="btn btn-primary">Save Transaction</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Add Modal with Multiple Transactions -->
  <div class="modal fade" id="quickAddModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Quick Add Transactions</h5>
          <button class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="mb-4">
            <label class="form-label">Enter transactions in natural language (one per line):</label>
            <textarea id="quickAddInput" class="form-control" rows="4" placeholder="Examples:&#10;• Add 500 to cash&#10;• Spent 200 on petrol from SBI&#10;• Received 1000 payment from client in AXIS&#10;• Transfer 500 from SBI to HDFC"></textarea>
          </div>
          
          <div class="quick-add-multiple">
            <h6 class="mb-3">Or add multiple transactions manually:</h6>
            <div id="multipleTransactionsContainer">
              <div class="multiple-transaction fade-in">
                <div class="row g-3">
                  <div class="col-md-3">
                    <label class="form-label">Type</label>
                    <select class="form-select multiple-type">
                      <option value="Income">Income</option>
                      <option value="Expense">Expense</option>
                    </select>
                  </div>
                  <div class="col-md-3">
                    <label class="form-label">Amount</label>
                    <input type="number" step="0.01" class="form-control multiple-amount" placeholder="0.00">
                  </div>
                  <div class="col-md-3">
                    <label class="form-label">Bank</label>
                    <select class="form-select multiple-bank">
                      <option value="CASH">CASH</option>
                      <option value="AXIS">AXIS</option>
                      <option value="BOM">BOM</option>
                      <option value="SBI">SBI</option>
                    </select>
                  </div>
                  <div class="col-md-3">
                    <label class="form-label">Description</label>
                    <input type="text" class="form-control multiple-description" placeholder="Description">
                  </div>
                </div>
              </div>
            </div>
            <button id="addTransactionRow" class="add-transaction-btn mt-3">
              <i class="fa fa-plus me-2"></i> Add Another Transaction
            </button>
          </div>
          
          <div class="card bg-light mt-4">
            <div class="card-body py-3">
              <small class="text-muted">
                <strong>Format examples:</strong><br>
                • Add [amount] to [account]<br>
                • Spent [amount] on [category] from [bank]<br>
                • Received [amount] for [description] in [bank]<br>
                • Transfer [amount] from [bank1] to [bank2]<br>
                • You can include dates like "yesterday", "last friday", "15th jan"
              </small>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button id="processQuickAddBtn" class="btn btn-primary">Process All Transactions</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Split Income Modal -->
  <div class="modal fade" id="splitIncomeModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Split Income into Multiple Expenses</h5>
          <button class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="mb-4">
            <label class="form-label">Income Amount to Split</label>
            <input id="splitIncomeAmount" type="number" step="0.01" class="form-control" placeholder="Enter total income amount" />
          </div>
          <div class="mb-4">
            <label class="form-label">Income Description</label>
            <input id="splitIncomeDescription" type="text" class="form-control" placeholder="Description for the income transaction" />
          </div>
          <div class="mb-4">
            <label class="form-label">Income Bank Account</label>
            <select id="splitIncomeBank" class="form-select">
              <option value="">Select Bank</option>
              <option value="AXIS">AXIS</option>
              <option value="BOM">BOM</option>
              <option value="CASH">CASH</option>
              <option value="SBI">SBI</option>
            </select>
          </div>
          
          <div class="d-flex justify-content-between align-items-center mb-4">
            <h6>Expense Transactions</h6>
            <button type="button" id="addSplitExpenseBtn" class="btn btn-sm btn-primary">
              <i class="fa fa-plus me-2"></i> Add Expense
            </button>
          </div>
          
          <div id="splitExpensesContainer">
            <!-- Split expense items will be added here -->
          </div>
          
          <div id="splitSummary" class="split-summary">
            <!-- Summary will be updated here -->
          </div>
        </div>
        <div class="modal-footer">
          <button data-bs-dismiss="modal" class="btn btn-outline-secondary">Cancel</button>
          <button id="saveSplitTransactionsBtn" class="btn btn-primary">Save All Transactions</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Bulk Edit Modal -->
  <div class="modal fade" id="bulkEditModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Bulk Edit Transactions</h5>
          <button class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="mb-4">
            <label class="form-label">Update Field</label>
            <select id="bulkEditField" class="form-select">
              <option value="BANK_NAME">Bank Name</option>
              <option value="ACCOUNT_HEADER">Account Header</option>
              <option value="TYPE">Transaction Type</option>
              <option value="VOUCHER_TYPE">Voucher Type</option>
            </select>
          </div>
          <div class="mb-4">
            <label class="form-label">New Value</label>
            <input id="bulkEditValue" type="text" class="form-control" placeholder="Enter new value" />
          </div>
          <div class="alert alert-info">
            <small>This will update <span id="bulkEditCount">0</span> selected transactions.</small>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button id="confirmBulkEditBtn" class="btn btn-primary">Update Transactions</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Attachment modal -->
  <div class="modal fade" id="attachmentModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Attachment</h5>
          <button class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body text-center" id="attachmentModalBody">
          <!-- filled dynamically -->
        </div>
      </div>
    </div>
  </div>

  <!-- Delete confirm -->
  <div class="modal fade" id="confirmDeleteModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-sm modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-body">Are you sure you want to delete this transaction?</div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button id="confirmDeleteBtn" class="btn btn-danger">Delete</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Bulk Delete Confirm -->
  <div class="modal fade" id="confirmBulkDeleteModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-sm modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-body">Are you sure you want to delete <span id="bulkDeleteCount">0</span> selected transactions?</div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button id="confirmBulkDeleteBtn" class="btn btn-danger">Delete All</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading Modal -->
  <div class="modal fade" id="loadingModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-sm modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-body text-center">
          <div class="spinner-border text-primary mb-3" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <p id="loadingMessage">Processing transaction...</p>
        </div>
      </div>
    </div>
  </div>

  <!-- floating add button -->
  <div class="floating-add" id="floatingAdd"><i class="fa fa-plus"></i></div>

  <!-- Chart.js for visualizations -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // Initialize UI interactions
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize tooltips
      var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
      var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl)
      });
      
      // Balance toggle functionality
      const balanceToggle = document.getElementById('balanceToggle');
      const balanceElements = document.querySelectorAll('.balance-hidden, .bank-balance-value');
      
      balanceToggle.addEventListener('click', function() {
        const isHidden = balanceToggle.querySelector('i').classList.contains('fa-eye-slash');
        
        if (isHidden) {
          balanceToggle.innerHTML = '<i class="fa fa-eye"></i>';
          document.querySelectorAll('.balance-hidden').forEach(el => {
            el.textContent = '$33.00';
            el.classList.remove('balance-hidden');
          });
          document.querySelectorAll('.bank-balance-value').forEach(el => {
            const currentText = el.textContent;
            if (currentText.includes('••••')) {
              el.textContent = el.getAttribute('data-actual-value') || '$1,000.00';
            }
          });
        } else {
          balanceToggle.innerHTML = '<i class="fa fa-eye-slash"></i>';
          document.querySelectorAll('.stat-value').forEach(el => {
            if (el.id === 'statBalance') {
              el.textContent = '••••';
              el.classList.add('balance-hidden');
            }
          });
          document.querySelectorAll('.bank-balance-value').forEach(el => {
            el.setAttribute('data-actual-value', el.textContent);
            el.textContent = '••••';
          });
        }
      });
      
      // Add transaction row in quick add modal
      document.getElementById('addTransactionRow').addEventListener('click', function() {
        const container = document.getElementById('multipleTransactionsContainer');
        const newRow = document.createElement('div');
        newRow.className = 'multiple-transaction fade-in';
        newRow.innerHTML = `
          <div class="row g-3">
            <div class="col-md-3">
              <label class="form-label">Type</label>
              <select class="form-select multiple-type">
                <option value="Income">Income</option>
                <option value="Expense">Expense</option>
              </select>
            </div>
            <div class="col-md-3">
              <label class="form-label">Amount</label>
              <input type="number" step="0.01" class="form-control multiple-amount" placeholder="0.00">
            </div>
            <div class="col-md-3">
              <label class="form-label">Bank</label>
              <select class="form-select multiple-bank">
                <option value="CASH">CASH</option>
                <option value="AXIS">AXIS</option>
                <option value="BOM">BOM</option>
                <option value="SBI">SBI</option>
              </select>
            </div>
            <div class="col-md-3">
              <label class="form-label">Description</label>
              <input type="text" class="form-control multiple-description" placeholder="Description">
            </div>
          </div>
        `;
        container.appendChild(newRow);
      });
      
      // Add split expense row
      document.getElementById('addSplitExpenseBtn').addEventListener('click', function() {
        addSplitExpense();
      });
      
      // Initialize with one split expense
      function addSplitExpense() {
        const container = document.getElementById('splitExpensesContainer');
        const expenseId = 'expense-' + Date.now();
        const expenseHtml = `
          <div class="split-transaction-item fade-in" id="${expenseId}">
            <div class="split-header">
              <h6>Expense</h6>
              <button type="button" class="remove-split" onclick="removeSplitExpense('${expenseId}')">
                <i class="fa fa-times"></i>
              </button>
            </div>
            <div class="row g-3">
              <div class="col-md-3">
                <label class="form-label">Amount</label>
                <input type="number" step="0.01" class="form-control split-amount-input" placeholder="0.00" oninput="updateSplitSummary()">
              </div>
              <div class="col-md-3">
                <label class="form-label">Description</label>
                <input type="text" class="form-control split-description-input" placeholder="Expense description">
              </div>
              <div class="col-md-3">
                <label class="form-label">Bank Account</label>
                <select class="form-select split-bank-input">
                  <option value="">Select Bank</option>
                  <option value="AXIS">AXIS</option>
                  <option value="BOM">BOM</option>
                  <option value="CASH">CASH</option>
                  <option value="SBI">SBI</option>
                </select>
              </div>
              <div class="col-md-3">
                <label class="form-label">Account Header</label>
                <select class="form-select split-account-input">
                  <option value="">Select Account Header</option>
                  <option value="Petrol">Petrol</option>
                  <option value="Food">Food</option>
                  <option value="Healthcare">Healthcare</option>
                  <option value="Shopping">Shopping</option>
                  <option value="Utilities">Utilities</option>
                </select>
              </div>
            </div>
          </div>
        `;
        
        container.insertAdjacentHTML('beforeend', expenseHtml);
        updateSplitSummary();
      }
      
      // Initialize with one split expense
      addSplitExpense();
      
      // Row selection functionality
      const selectAllCheckbox = document.getElementById('selectAllCheckbox');
      const rowCheckboxes = document.querySelectorAll('.row-checkbox');
      
      selectAllCheckbox.addEventListener('change', function() {
        const isChecked = this.checked;
        rowCheckboxes.forEach(checkbox => {
          checkbox.checked = isChecked;
          const row = checkbox.closest('tr');
          if (isChecked) {
            row.classList.add('selected');
          } else {
            row.classList.remove('selected');
          }
        });
        updateBulkActions();
      });
      
      rowCheckboxes.forEach(checkbox => {
        checkbox.addEventListener('change', function() {
          const row = this.closest('tr');
          if (this.checked) {
            row.classList.add('selected');
          } else {
            row.classList.remove('selected');
            selectAllCheckbox.checked = false;
          }
          updateBulkActions();
        });
      });
      
      function updateBulkActions() {
        const selectedCount = document.querySelectorAll('.row-checkbox:checked').length;
        document.getElementById('selectedCount').textContent = `${selectedCount} transaction${selectedCount !== 1 ? 's' : ''} selected`;
        
        if (selectedCount > 0) {
          document.getElementById('bulkActions').classList.remove('hidden');
        } else {
          document.getElementById('bulkActions').classList.add('hidden');
        }
      }
      
      // Theme toggle
      const themeToggle = document.getElementById('themeToggle');
      themeToggle.addEventListener('click', function() {
        const currentTheme = document.documentElement.getAttribute('data-theme');
        if (currentTheme === 'dark') {
          document.documentElement.removeAttribute('data-theme');
          themeToggle.innerHTML = '<i class="fa fa-moon"></i>';
          localStorage.setItem('theme', 'light');
        } else {
          document.documentElement.setAttribute('data-theme', 'dark');
          themeToggle.innerHTML = '<i class="fa fa-sun"></i>';
          localStorage.setItem('theme', 'dark');
        }
      });
      
      // Load saved theme
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme === 'dark') {
        document.documentElement.setAttribute('data-theme', 'dark');
        themeToggle.innerHTML = '<i class="fa fa-sun"></i>';
      }
    });
    
    // Global functions for split expenses
    function removeSplitExpense(id) {
      const element = document.getElementById(id);
      if (element) {
        element.remove();
        updateSplitSummary();
      }
    }
    
    function updateSplitSummary() {
      const incomeAmount = parseFloat(document.getElementById('splitIncomeAmount').value) || 0;
      const expenseElements = document.querySelectorAll('.split-transaction-item');
      
      let totalExpenses = 0;
      expenseElements.forEach(element => {
        const amountInput = element.querySelector('.split-amount-input');
        const amount = parseFloat(amountInput.value) || 0;
        totalExpenses += amount;
      });
      
      const remaining = incomeAmount - totalExpenses;
      const summaryElement = document.getElementById('splitSummary');
      
      let summaryHtml = '';
      if (incomeAmount > 0) {
        summaryHtml = `
          <div class="d-flex justify-content-between">
            <span>Total Income:</span>
            <span>$${incomeAmount.toFixed(2)}</span>
          </div>
          <div class="d-flex justify-content-between">
            <span>Total Expenses:</span>
            <span>$${totalExpenses.toFixed(2)}</span>
          </div>
          <div class="d-flex justify-content-between ${remaining >= 0 ? 'amount-remaining' : 'amount-exceeded'}">
            <span>Remaining:</span>
            <span>$${remaining.toFixed(2)}</span>
          </div>
        `;
        
        if (remaining < 0) {
          summaryHtml += `<div class="text-danger small mt-2">Warning: Expenses exceed income by $${Math.abs(remaining).toFixed(2)}</div>`;
        } else if (remaining > 0) {
          summaryHtml += `<div class="text-warning small mt-2">Note: $${remaining.toFixed(2)} of income not allocated</div>`;
        } else {
          summaryHtml += `<div class="text-success small mt-2">Perfect! All income allocated to expenses</div>`;
        }
      }
      
      summaryElement.innerHTML = summaryHtml;
    }
  </script>
</body>
</html>
